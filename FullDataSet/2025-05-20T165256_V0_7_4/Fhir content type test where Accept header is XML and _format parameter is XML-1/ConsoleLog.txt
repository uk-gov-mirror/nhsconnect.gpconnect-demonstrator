GenericSteps() Constructor
InitializeContainer For Dependency Injection
24 Patients Loaded From PDS CSV File.
5 Organisations Loaded From ODS CSV File.
4 Genders Loaded From FHIR ValueSet File.
6 MaritalStatus Loaded From FHIR ValueSet File.
55 Relationship Loaded From FHIR ValueSet File.
190 HumanLanguage Loaded From FHIR ValueSet File.
Feature: Fhir Base

Scenario: Fhir content type test where Accept header is XML and _format parameter is XML
SecuritySteps() Constructor
SecurityContext->LoadAppConfig()
useTLS=True
clientCertThumbPrint=47 6A 52 2D 5C D5 7A 69 4F CD AF 59 C8 DA 22 5E 8E 80 DE 43
sendClientCert=False
validateServerCert=False
HttpHeaderHelper() Constructor
JwtHelper() Constructor
JwtSteps() Constructor
SetDefaultJWTValues()
HttpHelper() Constructor
HttpSteps() Constructor
HttpContext->LoadAppConfig()
fhirServerUrl=gpconnect-win1.itblab.nic.cfh.nhs.uk
fhirServerPort=443
fhirServerFhirBase=/gpconnect-demonstrator/v0/fhir
useWebProxy=False
webProxyUrl=localhost
webProxyPort=8889
spineProxyUrl=proxy.int.spine2.ncrs.nhs.uk
spineProxyPort=443
providerASID=200000000985
consumerASID=200000000985
All Header(s) Cleared
All Parameters Cleared
Force The Server Certificate Callback To Always Be True.
FhirSteps() Constructor
ClearFhirOperationParameters()
fhirRequestParameters=Hl7.Fhir.Model.Parameters
Mapped test NHS number 9000000001 to NHS Number 9658218865
Mapped test NHS number 9000000002 to NHS Number 9658218873
Mapped test NHS number 9000000003 to NHS Number 9658218881
Mapped test NHS number 9000000004 to NHS Number 9658218903
Mapped test NHS number 9000000005 to NHS Number 9658218989
Mapped test NHS number 9000000006 to NHS Number 9658218997
Mapped test NHS number 9000000007 to NHS Number 9658219004
Mapped test NHS number 9000000008 to NHS Number 9658219012
Mapped test NHS number 9000000009 to NHS Number 9658220142
Mapped test NHS number 9000000010 to NHS Number 9658220150
Mapped test NHS number 9000000011 to NHS Number 9658220223
Mapped test NHS number 9000000012 to NHS Number 9658220215
Mapped test NHS number 9000000013 to NHS Number 9658219691
Mapped test NHS number 9000000014 to NHS Number 9476718943
Mapped test NHS number 9000000015 to NHS Number 9658220169
HttpContext->LoadAppConfig()
fhirServerUrl=gpconnect-win1.itblab.nic.cfh.nhs.uk
fhirServerPort=443
fhirServerFhirBase=/gpconnect-demonstrator/v0/fhir
useWebProxy=False
webProxyUrl=localhost
webProxyPort=8889
spineProxyUrl=proxy.int.spine2.ncrs.nhs.uk
spineProxyPort=443
providerASID=200000000985
consumerASID=200000000985
Force The Server Certificate Callback To Always Be True.
Removed Key='Accept'
Added Key='Accept' Value='application/json+fhir'
Replaced Key='Accept' With Value='application/json+fhir'
requestContentType=application/json+fhir
Removed Key='Ssp-TraceID'
Added Key='Ssp-TraceID' Value='1a4695b3-fa76-4242-8154-c6d5abe3c690'
Replaced Key='Ssp-TraceID' With Value='1a4695b3-fa76-4242-8154-c6d5abe3c690'
Removed Key='Ssp-From'
Added Key='Ssp-From' Value='200000000985'
Replaced Key='Ssp-From' With Value='200000000985'
Removed Key='Ssp-To'
Added Key='Ssp-To' Value='200000000985'
Replaced Key='Ssp-To' With Value='200000000985'
Removed Key='Authorization'
Added Key='Authorization' Value='Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwczovL0NvbnN1bWVyU3lzdGVtVVJMIiwic3ViIjoiMSIsImF1ZCI6Imh0dHBzOi8vYXV0aG9yaXplLmZoaXIubmhzLm5ldC90b2tlbiIsImV4cCI6MTc0Nzc1Njc0MSwiaWF0IjoxNzQ3NzU2NDQxLCJyZWFzb25fZm9yX3JlcXVlc3QiOiJkaXJlY3RjYXJlIiwicmVxdWVzdGluZ19kZXZpY2UiOnsicmVzb3VyY2VUeXBlIjoiRGV2aWNlIiwiaWQiOiIxIiwiaWRlbnRpZmllciI6W3sic3lzdGVtIjoiR1BDb25uZWN0VGVzdFN5c3RlbSIsInZhbHVlIjoiQ2xpZW50In1dLCJtb2RlbCI6InYxIiwidmVyc2lvbiI6IjEuMSJ9LCJyZXF1ZXN0aW5nX29yZ2FuaXphdGlvbiI6eyJyZXNvdXJjZVR5cGUiOiJPcmdhbml6YXRpb24iLCJpZCI6IjEiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L0lkL29kcy1vcmdhbml6YXRpb24tY29kZSIsInZhbHVlIjoiR1BDQTAwMDEifV0sIm5hbWUiOiJHUCBDb25uZWN0IEFzc3VyYW5jZSJ9LCJyZXF1ZXN0aW5nX3ByYWN0aXRpb25lciI6eyJyZXNvdXJjZVR5cGUiOiJQcmFjdGl0aW9uZXIiLCJpZCI6IjEiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L3Nkcy11c2VyLWlkIiwidmFsdWUiOiJHQ0FTRFMwMDAxIn0seyJzeXN0ZW0iOiJodHRwczovL2NvbnN1bWVyc3VwcGxpZXIuY29tL0lkL3VzZXItZ3VpZCIsInZhbHVlIjoiOThlZDRmNzgtODE0ZC00MjY2LThkNWItY2RlNzQyZjMwOTNjIn1dLCJuYW1lIjp7ImZhbWlseSI6WyJBc3N1cmFuY2VQcmFjdGl0aW9uZXIiXSwiZ2l2ZW4iOlsiQXNzdXJhbmNlVGVzdCJdLCJwcmVmaXgiOlsiTXIiXX0sInByYWN0aXRpb25lclJvbGUiOlt7InJvbGUiOnsiY29kaW5nIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L1ZhbHVlU2V0L3Nkcy1qb2Itcm9sZS1uYW1lLTEiLCJjb2RlIjoiQXNzdXJhbmNlSm9iUm9sZSJ9XX19XX0sInJlcXVlc3RlZF9zY29wZSI6Im9yZ2FuaXphdGlvbi8qLnJlYWQiLCJyZXF1ZXN0ZWRfcmVjb3JkIjp7InJlc291cmNlVHlwZSI6Ik9yZ2FuaXphdGlvbiIsImlkIjoiMSIsImlkZW50aWZpZXIiOlt7InN5c3RlbSI6Imh0dHA6Ly9maGlyLm5ocy5uZXQvSWQvb2RzLW9yZ2FuaXphdGlvbi1jb2RlIiwidmFsdWUiOiJPcmdPRFNDb2RlMDAwMSJ9XSwibmFtZSI6IkdQIENvbm5lY3QgQXNzdXJhbmNlIn19.'
Replaced Key='Authorization' With Value='Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwczovL0NvbnN1bWVyU3lzdGVtVVJMIiwic3ViIjoiMSIsImF1ZCI6Imh0dHBzOi8vYXV0aG9yaXplLmZoaXIubmhzLm5ldC90b2tlbiIsImV4cCI6MTc0Nzc1Njc0MSwiaWF0IjoxNzQ3NzU2NDQxLCJyZWFzb25fZm9yX3JlcXVlc3QiOiJkaXJlY3RjYXJlIiwicmVxdWVzdGluZ19kZXZpY2UiOnsicmVzb3VyY2VUeXBlIjoiRGV2aWNlIiwiaWQiOiIxIiwiaWRlbnRpZmllciI6W3sic3lzdGVtIjoiR1BDb25uZWN0VGVzdFN5c3RlbSIsInZhbHVlIjoiQ2xpZW50In1dLCJtb2RlbCI6InYxIiwidmVyc2lvbiI6IjEuMSJ9LCJyZXF1ZXN0aW5nX29yZ2FuaXphdGlvbiI6eyJyZXNvdXJjZVR5cGUiOiJPcmdhbml6YXRpb24iLCJpZCI6IjEiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L0lkL29kcy1vcmdhbml6YXRpb24tY29kZSIsInZhbHVlIjoiR1BDQTAwMDEifV0sIm5hbWUiOiJHUCBDb25uZWN0IEFzc3VyYW5jZSJ9LCJyZXF1ZXN0aW5nX3ByYWN0aXRpb25lciI6eyJyZXNvdXJjZVR5cGUiOiJQcmFjdGl0aW9uZXIiLCJpZCI6IjEiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L3Nkcy11c2VyLWlkIiwidmFsdWUiOiJHQ0FTRFMwMDAxIn0seyJzeXN0ZW0iOiJodHRwczovL2NvbnN1bWVyc3VwcGxpZXIuY29tL0lkL3VzZXItZ3VpZCIsInZhbHVlIjoiOThlZDRmNzgtODE0ZC00MjY2LThkNWItY2RlNzQyZjMwOTNjIn1dLCJuYW1lIjp7ImZhbWlseSI6WyJBc3N1cmFuY2VQcmFjdGl0aW9uZXIiXSwiZ2l2ZW4iOlsiQXNzdXJhbmNlVGVzdCJdLCJwcmVmaXgiOlsiTXIiXX0sInByYWN0aXRpb25lclJvbGUiOlt7InJvbGUiOnsiY29kaW5nIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L1ZhbHVlU2V0L3Nkcy1qb2Itcm9sZS1uYW1lLTEiLCJjb2RlIjoiQXNzdXJhbmNlSm9iUm9sZSJ9XX19XX0sInJlcXVlc3RlZF9zY29wZSI6Im9yZ2FuaXphdGlvbi8qLnJlYWQiLCJyZXF1ZXN0ZWRfcmVjb3JkIjp7InJlc291cmNlVHlwZSI6Ik9yZ2FuaXphdGlvbiIsImlkIjoiMSIsImlkZW50aWZpZXIiOlt7InN5c3RlbSI6Imh0dHA6Ly9maGlyLm5ocy5uZXQvSWQvb2RzLW9yZ2FuaXphdGlvbi1jb2RlIiwidmFsdWUiOiJPcmdPRFNDb2RlMDAwMSJ9XSwibmFtZSI6IkdQIENvbm5lY3QgQXNzdXJhbmNlIn19.'
Removed Key='Ssp-InteractionId'
Added Key='Ssp-InteractionId' Value='urn:nhs:names:services:gpconnect:fhir:rest:read:metadata'
Replaced Key='Ssp-InteractionId' With Value='urn:nhs:names:services:gpconnect:fhir:rest:read:metadata'
requestContentType=application/xml+fhir
Removed Key='Accept'
Added Key='Accept' Value='application/xml+fhir'
Replaced Key='Accept' With Value='application/xml+fhir'
Added Key='_format' Value='application/xml+fhir'
GET relative URL = /metadata
requestMethod=GET
requestUrl=/metadata
requestBody=
endpointAddress=https://gpconnect-win1.itblab.nic.cfh.nhs.uk/gpconnect-demonstrator/v0/fhir
Added Key='Content-Type' Value='application/xml+fhir'
GetRequestHeaders Count='7'
Header - Accept -> application/xml+fhir
Header - Ssp-TraceID -> 1a4695b3-fa76-4242-8154-c6d5abe3c690
Header - Ssp-From -> 200000000985
Header - Ssp-To -> 200000000985
Header - Authorization -> Bearer eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpc3MiOiJodHRwczovL0NvbnN1bWVyU3lzdGVtVVJMIiwic3ViIjoiMSIsImF1ZCI6Imh0dHBzOi8vYXV0aG9yaXplLmZoaXIubmhzLm5ldC90b2tlbiIsImV4cCI6MTc0Nzc1Njc0MSwiaWF0IjoxNzQ3NzU2NDQxLCJyZWFzb25fZm9yX3JlcXVlc3QiOiJkaXJlY3RjYXJlIiwicmVxdWVzdGluZ19kZXZpY2UiOnsicmVzb3VyY2VUeXBlIjoiRGV2aWNlIiwiaWQiOiIxIiwiaWRlbnRpZmllciI6W3sic3lzdGVtIjoiR1BDb25uZWN0VGVzdFN5c3RlbSIsInZhbHVlIjoiQ2xpZW50In1dLCJtb2RlbCI6InYxIiwidmVyc2lvbiI6IjEuMSJ9LCJyZXF1ZXN0aW5nX29yZ2FuaXphdGlvbiI6eyJyZXNvdXJjZVR5cGUiOiJPcmdhbml6YXRpb24iLCJpZCI6IjEiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L0lkL29kcy1vcmdhbml6YXRpb24tY29kZSIsInZhbHVlIjoiR1BDQTAwMDEifV0sIm5hbWUiOiJHUCBDb25uZWN0IEFzc3VyYW5jZSJ9LCJyZXF1ZXN0aW5nX3ByYWN0aXRpb25lciI6eyJyZXNvdXJjZVR5cGUiOiJQcmFjdGl0aW9uZXIiLCJpZCI6IjEiLCJpZGVudGlmaWVyIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L3Nkcy11c2VyLWlkIiwidmFsdWUiOiJHQ0FTRFMwMDAxIn0seyJzeXN0ZW0iOiJodHRwczovL2NvbnN1bWVyc3VwcGxpZXIuY29tL0lkL3VzZXItZ3VpZCIsInZhbHVlIjoiOThlZDRmNzgtODE0ZC00MjY2LThkNWItY2RlNzQyZjMwOTNjIn1dLCJuYW1lIjp7ImZhbWlseSI6WyJBc3N1cmFuY2VQcmFjdGl0aW9uZXIiXSwiZ2l2ZW4iOlsiQXNzdXJhbmNlVGVzdCJdLCJwcmVmaXgiOlsiTXIiXX0sInByYWN0aXRpb25lclJvbGUiOlt7InJvbGUiOnsiY29kaW5nIjpbeyJzeXN0ZW0iOiJodHRwOi8vZmhpci5uaHMubmV0L1ZhbHVlU2V0L3Nkcy1qb2Itcm9sZS1uYW1lLTEiLCJjb2RlIjoiQXNzdXJhbmNlSm9iUm9sZSJ9XX19XX0sInJlcXVlc3RlZF9zY29wZSI6Im9yZ2FuaXphdGlvbi8qLnJlYWQiLCJyZXF1ZXN0ZWRfcmVjb3JkIjp7InJlc291cmNlVHlwZSI6Ik9yZ2FuaXphdGlvbiIsImlkIjoiMSIsImlkZW50aWZpZXIiOlt7InN5c3RlbSI6Imh0dHA6Ly9maGlyLm5ocy5uZXQvSWQvb2RzLW9yZ2FuaXphdGlvbi1jb2RlIiwidmFsdWUiOiJPcmdPRFNDb2RlMDAwMSJ9XSwibmFtZSI6IkdQIENvbm5lY3QgQXNzdXJhbmNlIn19.
Header - Ssp-InteractionId -> urn:nhs:names:services:gpconnect:fhir:rest:read:metadata
Header - Content-Type -> application/xml+fhir
GetRequestParameters Count='1'
Parameter - _format -> application/xml+fhir
responseTimeInMilliseconds=18
responseTimeAcceptable=True
Error Message = 
Error Exception = 
responseStatusCode=OK
responseContentType=application/xml+fhir;charset=UTF-8
responseBody=<Conformance xmlns="http://hl7.org/fhir"><version value="0.7.4"/><name value="GP Connect"/><publisher value="Not provided"/><date value="2025-05-20T09:29:25+01:00"/><description value="This server implements the GP Connect API version 0.7.4"/><copyright value="Copyright NHS Digital 2018"/><kind value="instance"/><software><name value="HAPI FHIR Server"/><version value="2.2"/><releaseDate value="2016-12-20T00:00:00+00:00"/></software><fhirVersion value="1.0.2"/><acceptUnknown value="extensions"/><format value="application/xml+fhir"/><format value="application/json+fhir"/><rest><mode value="server"/><resource><type value="OperationDefinition"/><profile><reference value="http://hl7.org/fhir/profiles/OperationDefinition"/></profile><interaction><code value="read"/></interaction></resource><resource><type value="Patient"/><profile><reference value="http://hl7.org/fhir/profiles/Patient"/></profile></resource><resource><type value="StructureDefinition"/><profile><reference value="http://hl7.org/fhir/profiles/StructureDefinition"/></profile><interaction><code value="read"/></interaction><interaction><code value="search-type"/></interaction></resource><operation><name value="gpc.getcarerecord"/><definition><reference value="OperationDefinition/Patient--gpc.getcarerecord"/></definition></operation></rest></Conformance>
Response Header: Transfer-Encoding : chunked
The given key was not present in the dictionary.
Response Header: Connection : keep-alive
Response Header: Content-Encoding : 
Response Header: Content-Type : application/xml+fhir;charset=UTF-8
Response Header: Date : Tue, 20 May 2025 15:54:01 GMT
Response Header: Server : nginx/1.19.6
Response Header: X-Powered-By : HAPI FHIR 2.2 REST Server (FHIR Server; FHIR 1.0.2/DSTU2)
C:\Temp\2025-05-20T165256\Fhir content type test where Accept header is XML and _format parameter is XML-1
GetRequestHeaders Count='7'
GetRequestParameters Count='1'
webProxyAddress=https://localhost:8889
spineProxyAddress=https://proxy.int.spine2.ncrs.nhs.uk:443
endpointAddress=https://gpconnect-win1.itblab.nic.cfh.nhs.uk/gpconnect-demonstrator/v0/fhir
Exception writing JSONResponse to Output File
GetRequestHeaders Count='7'
Exception writing JSONRequestBody to Output File - Request May Not be JSON
Exception writing HTMLResponse to Output File - Reponse May not Include HTML. Exception Message : Unexpected character encountered while parsing value: <. Path '', line 0, position 0.
Response ContentType=application/xml+fhir;charset=UTF-8
responseXML=<Conformance xmlns="http://hl7.org/fhir">
  <version value="0.7.4" />
  <name value="GP Connect" />
  <publisher value="Not provided" />
  <date value="2025-05-20T09:29:25+01:00" />
  <description value="This server implements the GP Connect API version 0.7.4" />
  <copyright value="Copyright NHS Digital 2018" />
  <kind value="instance" />
  <software>
    <name value="HAPI FHIR Server" />
    <version value="2.2" />
    <releaseDate value="2016-12-20T00:00:00+00:00" />
  </software>
  <fhirVersion value="1.0.2" />
  <acceptUnknown value="extensions" />
  <format value="application/xml+fhir" />
  <format value="application/json+fhir" />
  <rest>
    <mode value="server" />
    <resource>
      <type value="OperationDefinition" />
      <profile>
        <reference value="http://hl7.org/fhir/profiles/OperationDefinition" />
      </profile>
      <interaction>
        <code value="read" />
      </interaction>
    </resource>
    <resource>
      <type value="Patient" />
      <profile>
        <reference value="http://hl7.org/fhir/profiles/Patient" />
      </profile>
    </resource>
    <resource>
      <type value="StructureDefinition" />
      <profile>
        <reference value="http://hl7.org/fhir/profiles/StructureDefinition" />
      </profile>
      <interaction>
        <code value="read" />
      </interaction>
      <interaction>
        <code value="search-type" />
      </interaction>
    </resource>
    <operation>
      <name value="gpc.getcarerecord" />
      <definition>
        <reference value="OperationDefinition/Patient--gpc.getcarerecord" />
      </definition>
    </operation>
  </rest>
</Conformance>
fhirResponseResource=Hl7.Fhir.Model.Conformance
